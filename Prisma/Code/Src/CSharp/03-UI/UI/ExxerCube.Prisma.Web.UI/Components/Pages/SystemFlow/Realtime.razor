@page "/system-flow/realtime"
@namespace ExxerCube.Prisma.Web.UI.Components.Pages.SystemFlow

<PageTitle>Real-time Signals - ExxerCube Prisma</PageTitle>

<MudContainer MaxWidth="MaxWidth.Large" Class="mt-4 mb-8">
    <MudBreadcrumbs Items="_breadcrumbs" Class="mb-4" />

    <MudPaper Elevation="0" Class="pa-6 mb-6" Style="background: linear-gradient(135deg, #e0f2f1 0%, #b2dfdb 100%); border-radius: 12px;">
        <MudText Typo="Typo.h4" Style="color: #00695c; font-weight: 600;" Class="mb-2">
            <MudIcon Icon="@Icons.Material.Filled.AutoAwesome" Class="mr-2" Size="Size.Large" />
            Real-time UI & SignalR
        </MudText>
        <MudText Typo="Typo.body1" Style="color: #00695c;">
            Static demo of the processing status stream, notifications, and live metrics surfaced via SignalR (no backend calls yet).
        </MudText>
    </MudPaper>

    <MudGrid Spacing="3" Class="mb-6">
        <MudItem xs="12" md="6">
            <MudCard Elevation="3">
                <MudCardHeader>
                    <CardHeaderContent>
                        <MudText Typo="Typo.h6">
                            <MudIcon Icon="@Icons.Material.Filled.Podcasts" Class="mr-1" />
                            ProcessingHub Stream
                        </MudText>
                    </CardHeaderContent>
                </MudCardHeader>
                <MudCardContent>
                    <MudText Typo="Typo.body2" Class="mb-2">
                        Live feed placeholder showing job events (connected/disconnected, file queued, processing, completed).
                    </MudText>
                    <MudList T="string" Dense="true">
                        <MudListItem T="string">
                            <MudIcon Icon="@Icons.Material.Filled.CheckCircle" Color="Color.Success" Class="mr-2" />
                            Connected to /processingHub
                        </MudListItem>
                        <MudListItem T="string">
                            <MudIcon Icon="@Icons.Material.Filled.Queue" Color="Color.Info" Class="mr-2" />
                            File 12345 queued for OCR
                        </MudListItem>
                        <MudListItem T="string">
                            <MudIcon Icon="@Icons.Material.Filled.AutoFixHigh" Color="Color.Warning" Class="mr-2" />
                            OCR running (Tesseract spa+eng)
                        </MudListItem>
                        <MudListItem T="string">
                            <MudIcon Icon="@Icons.Material.Filled.AssignmentTurnedIn" Color="Color.Success" Class="mr-2" />
                            Export package ready
                        </MudListItem>
                    </MudList>
                </MudCardContent>
            </MudCard>
        </MudItem>

        <MudItem xs="12" md="6">
            <MudCard Elevation="3">
                <MudCardHeader>
                    <CardHeaderContent>
                        <MudText Typo="Typo.h6">
                            <MudIcon Icon="@Icons.Material.Filled.NotificationsActive" Class="mr-1" />
                            Notifications
                        </MudText>
                    </CardHeaderContent>
                </MudCardHeader>
                <MudCardContent>
                    <MudAlert Severity="Severity.Success" Class="mb-2" Dense="true">
                        Export 2025-11-29-001 delivered to bank template.
                    </MudAlert>
                    <MudAlert Severity="Severity.Info" Class="mb-2" Dense="true">
                        Reconciliation complete for Case-8891 (high confidence).
                    </MudAlert>
                    <MudAlert Severity="Severity.Warning" Class="mb-2" Dense="true">
                        SLA at-risk: Case-7710 nearing threshold.
                    </MudAlert>
                    <MudAlert Severity="Severity.Error" Dense="true">
                        Connection drop detected â€” will attempt automatic reconnection.
                    </MudAlert>
                </MudCardContent>
            </MudCard>
        </MudItem>
    </MudGrid>

    <MudGrid Spacing="3">
        <MudItem xs="12" md="6">
            <MudCard Elevation="3">
                <MudCardHeader>
                    <CardHeaderContent>
                        <MudText Typo="Typo.h6">
                            <MudIcon Icon="@Icons.Material.Filled.Timeline" Class="mr-1" />
                            Live Metrics (stub)
                        </MudText>
                    </CardHeaderContent>
                </MudCardHeader>
                <MudCardContent>
                    <MudProgressLinear Color="Color.Primary" Value="65" Class="mb-2" />
                    <MudText Typo="Typo.caption">65% documents processed today</MudText>
                    <MudProgressLinear Color="Color.Success" Value="82" Class="mb-2" />
                    <MudText Typo="Typo.caption">SLA compliance (target 95%)</MudText>
                    <MudProgressLinear Color="Color.Warning" Value="30" Class="mb-2" />
                    <MudText Typo="Typo.caption">Reconciliation queue depth</MudText>
                </MudCardContent>
            </MudCard>
        </MudItem>

        <MudItem xs="12" md="6">
            <MudCard Elevation="3">
                <MudCardHeader>
                    <CardHeaderContent>
                        <MudText Typo="Typo.h6">
                            <MudIcon Icon="@Icons.Material.Filled.ListAlt" Class="mr-1" />
                            Connection & Retry Policy
                        </MudText>
                    </CardHeaderContent>
                </MudCardHeader>
                <MudCardContent>
                    <MudList T="string" Dense="true">
                        <MudListItem T="string">
                            <MudIcon Icon="@Icons.Material.Filled.Link" Class="mr-2" />
                            Endpoint: <code>/processingHub</code>
                        </MudListItem>
                        <MudListItem T="string">
                            <MudIcon Icon="@Icons.Material.Filled.Sync" Class="mr-2" />
                            Auto-reconnect with backoff (stub UI)
                        </MudListItem>
                        <MudListItem T="string">
                            <MudIcon Icon="@Icons.Material.Filled.Security" Class="mr-2" />
                            Auth: Identity cookie (demo placeholder)
                        </MudListItem>
                        <MudListItem T="string">
                            <MudIcon Icon="@Icons.Material.Filled.HealthAndSafety" Class="mr-2" />
                            Health: /health endpoint (checks SLA enforcer + background jobs)
                        </MudListItem>
                    </MudList>
                    <MudAlert Severity="Severity.Info" Dense="true" Class="mt-2">
                        This view is static for now; hook SignalR client here to make it live.
                    </MudAlert>
                </MudCardContent>
            </MudCard>
        </MudItem>
    </MudGrid>
</MudContainer>

@code {
    private readonly List<BreadcrumbItem> _breadcrumbs = new()
    {
        new BreadcrumbItem("Home", href: "/"),
        new BreadcrumbItem("System Flow", href: "/system-flow"),
        new BreadcrumbItem("Real-time Signals", href: null, disabled: true)
    };
}